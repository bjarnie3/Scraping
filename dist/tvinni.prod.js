"use strict";var puppeteer=require("puppeteer"),cheerio=require("cheerio");function scrapeListings(r){var n,c,t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(r.goto("https://www.tvinna.is"));case 2:return e.sent,e.next=5,regeneratorRuntime.awrap(r.content());case 5:n=e.sent,c=cheerio.load(n),t=c(".job-listing > ul > li").map(function(e,r){var n=c(r).find("h2"),t=c(n).text(),a=c(r).find("p"),s=c(a).text(),o=c(r).find("a").attr("href"),i=c(r).find("time");return{Starf:t,Vinna:s,datePosted:new Date(c(i).find(".year").text()),url:o}}).get(),console.log(t);case 9:case"end":return e.stop()}})}function scrapeJobDescriptions(r,n){var t,a,s,o,i;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(n.goto("https://www.tvinna.is"));case 2:t=0;case 3:if(t<r.length)return e.next=6,regeneratorRuntime.awrap(n.goto(r[t].url));e.next=21;break;case 6:return e.next=8,regeneratorRuntime.awrap(n.content());case 8:return a=e.sent,s=cheerio.load(a),o=s(".job-listing > p"),r[t].jobDescription=o,console.log(r[t].jobDescription),i=new Listing(r[t]),e.next=16,regeneratorRuntime.awrap(i.save());case 16:return e.next=18,regeneratorRuntime.awrap(sleep(1e3));case 18:t++,e.next=3;break;case 21:case"end":return e.stop()}})}function sleep(r){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return setTimeout(e,r)}));case 1:case"end":return e.stop()}})}function main(){var r,n,t,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(puppeteer.launch({headless:!1}));case 2:return r=e.sent,e.next=5,regeneratorRuntime.awrap(r.newPage());case 5:return n=e.sent,e.next=8,regeneratorRuntime.awrap(scrapeListings(n));case 8:return t=e.sent,e.next=11,regeneratorRuntime.awrap(scrapeJobDescriptions(t,n));case 11:a=e.sent,console.log(a),console.log(t);case 14:case"end":return e.stop()}})}main();